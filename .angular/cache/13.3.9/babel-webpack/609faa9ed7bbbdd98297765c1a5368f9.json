{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Persona } from 'src/app/models/persona';\nimport { Utilidades } from 'src/app/models/utilidades';\nimport { PersonaService } from 'src/app/services/persona.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/persona.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../select-tipos-persona/select-tipos-persona.component\";\nimport * as i4 from \"../select-tipos-documento/select-tipos-documento.component\";\nimport * as i5 from \"../select-departamentos/select-departamentos.component\";\nimport * as i6 from \"../select-municipios/select-municipios.component\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../personas/personas.component\";\nconst _c0 = [\"divForm\"];\nconst _c1 = [\"listadoPersonas\"];\nconst _c2 = [\"selectMunicipios\"];\nconst _c3 = [\"selectDepartamentos\"];\n\nfunction PersonaComponent_div_68_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function PersonaComponent_div_68_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.eliminar();\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.persona.id == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.botones.eliminar, \" \");\n  }\n}\n\nfunction PersonaComponent_div_73_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"app-personas\", 33, 34);\n    i0.ɵɵlistener(\"personaSeleccionada\", function PersonaComponent_div_73_Template_app_personas_personaSeleccionada_1_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.personaSeleccionada($event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\n\nexport let PersonaComponent = /*#__PURE__*/(() => {\n  class PersonaComponent {\n    constructor(_personaService) {\n      this._personaService = _personaService;\n      this.persona = new Persona();\n      this.creacionPersona = false;\n      this.personaCreada = new EventEmitter();\n      this.labels = {\n        tipo: 'Tipo',\n        departamento: 'Departamento',\n        municipio: 'Municipio',\n        domicilio: 'Domicilio',\n        identificacion: 'Identificación',\n        numeroDocumento: 'Número de documento',\n        nombreCompleto: 'Nombre completo',\n        nombres: 'Nombres',\n        apellidos: 'Apellidos',\n        razonSocial: 'Razón social',\n        contacto: 'Contacto',\n        direccion: 'Direccion',\n        telefono: 'telefono',\n        email: 'E-mail'\n      };\n      this.botones = {\n        eliminar: 'Eliminar',\n        guardar: 'Guardar'\n      };\n      this.mensajes = {\n        personaCreada: 'La persona se ha creado correctamente',\n        personaActualizada: 'La persona se ha actualizado correctamente',\n        preguntaEliminar: '¿Está seguro de eliminar el registro? Esta opción no se puede deshacer.',\n        personaEliminada: 'La persona se ha eliminado correctamente'\n      };\n    }\n\n    ngOnInit() {}\n\n    ngAfterViewInit() {\n      if (!this.creacionPersona) {\n        this.listadoPersonas.consultarListado();\n        setTimeout(() => {\n          this.onResize();\n        });\n      }\n    }\n\n    departamentoSeleccionado(departamento) {\n      this.persona.municipio.departamento = departamento;\n      this.selectMunicipios.departamento = this.persona.municipio.departamento;\n      this.selectMunicipios.consultarMunicipios();\n    }\n\n    municipioSeleccionado(municipio) {\n      this.persona.municipio = municipio;\n    }\n\n    tipoPersonaSeleccionado(tipoPersona) {\n      this.persona.tipo = tipoPersona;\n    }\n\n    tipoDocumentoSeleccionado(tipoDocumento) {\n      this.persona.tipoDocumento = tipoDocumento;\n    }\n\n    onResize() {\n      if (!this.creacionPersona) {\n        let altoDivForm = this.divForm.nativeElement.offsetHeight;\n        let altoDivTabla = window.innerHeight - altoDivForm - 140;\n\n        if (altoDivTabla != this.listadoPersonas.altoTabla) {\n          this.listadoPersonas.altoTabla = altoDivTabla;\n        }\n      }\n    }\n\n    personaSeleccionada(id) {\n      this._personaService.consultarPorId(id).subscribe(result => {\n        if (result.datos) {\n          this.persona = new Persona();\n          this.persona.inicializar(result.datos);\n          this.establecerMunicipio();\n        }\n      });\n    }\n\n    guardar() {\n      if (this.persona.id == 0) {\n        this.crear();\n      } else {\n        this.actualizar();\n      }\n    }\n\n    crear() {\n      this._personaService.crear(this.persona).subscribe(result => {\n        if (result.resultado) {\n          this.persona.id = result.datos.id;\n\n          if (this.creacionPersona) {\n            this.personaCreada.emit(this.persona);\n          } else {\n            this.listadoPersonas.consultarListado();\n          }\n\n          Utilidades.dialogSuccess(this.mensajes.personaCreada);\n        }\n      }, error => {\n        Utilidades.dialogErrorHttp(error.error.codigo_http, error.error.mensaje);\n      });\n    }\n\n    actualizar() {\n      this._personaService.actualizar(this.persona).subscribe(result => {\n        if (result.resultado) {\n          this.listadoPersonas.consultarListado();\n          Utilidades.dialogSuccess(this.mensajes.personaActualizada);\n        }\n      }, error => {\n        Utilidades.dialogErrorHttp(error.error.codigo_http, error.error.mensaje);\n      });\n    }\n\n    eliminar() {\n      Utilidades.dialogPregunta('', this.mensajes.preguntaEliminar, 'Sí, eliminar').then(result => {\n        if (result.isConfirmed) {\n          this._personaService.eliminar(this.persona.id).subscribe(result => {\n            if (result.resultado) {\n              this.listadoPersonas.consultarListado();\n              this.limpiar();\n              Utilidades.dialogSuccess(this.mensajes.personaEliminada);\n            }\n          }, error => {\n            Utilidades.dialogErrorHttp(error.error.codigo_http, error.error.mensaje);\n          });\n        }\n      });\n    }\n\n    limpiar() {\n      this.persona = new Persona();\n      this.establecerMunicipio();\n    }\n\n    establecerMunicipio() {\n      this.selectDepartamentos.departamento = this.persona.municipio.departamento;\n      this.selectMunicipios.departamento = this.persona.municipio.departamento;\n      this.selectMunicipios.consultarMunicipios(this.persona.municipio);\n    }\n\n    formatearNombres(campo) {\n      if (campo == 'nombres') {\n        this.persona.nombres = this.primeraMayuscula(this.persona.nombres);\n      } else if (campo == 'apellidos') {\n        this.persona.apellidos = this.primeraMayuscula(this.persona.apellidos);\n      } else if (campo == 'razonSocial') {\n        this.persona.razonSocial = this.primeraMayuscula(this.persona.razonSocial);\n      }\n    }\n\n    primeraMayuscula(texto) {\n      texto = texto.trim();\n      let arrTexto = texto.split(' ');\n      let textoFinal = '';\n      arrTexto.forEach(palabra => {\n        palabra = palabra.charAt(0).toUpperCase() + palabra.slice(1);\n        textoFinal += palabra + ' ';\n      });\n      return textoFinal.trim();\n    }\n\n  }\n\n  PersonaComponent.ɵfac = function PersonaComponent_Factory(t) {\n    return new (t || PersonaComponent)(i0.ɵɵdirectiveInject(i1.PersonaService));\n  };\n\n  PersonaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PersonaComponent,\n    selectors: [[\"app-persona\"]],\n    viewQuery: function PersonaComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n        i0.ɵɵviewQuery(_c2, 5);\n        i0.ɵɵviewQuery(_c3, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.divForm = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.listadoPersonas = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.selectMunicipios = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.selectDepartamentos = _t.first);\n      }\n    },\n    hostBindings: function PersonaComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵlistener(\"resize\", function PersonaComponent_resize_HostBindingHandler($event) {\n          return ctx.onResize($event);\n        }, false, i0.ɵɵresolveWindow);\n      }\n    },\n    inputs: {\n      creacionPersona: \"creacionPersona\"\n    },\n    outputs: {\n      personaCreada: \"personaCreada\"\n    },\n    features: [i0.ɵɵProvidersFeature([PersonaService])],\n    decls: 74,\n    vars: 24,\n    consts: [[1, \"div-form\"], [\"divForm\", \"\"], [\"autocomplete\", \"off\"], [1, \"field\", \"is-horizontal\"], [1, \"field-label\", \"is-normal\"], [1, \"level-left\"], [1, \"field-body\"], [1, \"control\"], [1, \"select\"], [3, \"tipoPersona\", \"tipoPersonaSeleccionado\"], [1, \"field\", \"is-grouped\"], [3, \"tipoDocumento\", \"tipoDocumentoSeleccionado\"], [1, \"control\", \"is-expanded\"], [\"type\", \"text\", \"name\", \"numeroDocumento\", 1, \"input\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"nombres\", 1, \"input\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\", \"focusout\"], [\"type\", \"text\", \"name\", \"apellidos\", 1, \"input\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\", \"focusout\"], [\"type\", \"text\", \"name\", \"razonSocial\", 1, \"input\", 3, \"ngModel\", \"ngModelChange\", \"focusout\"], [3, \"departamentoSeleccionado\"], [\"selectDepartamentos\", \"\"], [3, \"municipioSeleccionado\"], [\"selectMunicipios\", \"\"], [\"type\", \"text\", \"name\", \"direccion\", 1, \"input\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"telefono\", 1, \"input\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"type\", \"email\", \"name\", \"email\", 1, \"input\", \"is-lowercase\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [1, \"field\", \"is-grouped\", \"is-grouped-right\"], [1, \"button\", \"is-primary\", 3, \"click\"], [\"class\", \"control\", 4, \"ngIf\"], [1, \"button\", 3, \"click\"], [1, \"icon\", \"has-text-primary\"], [1, \"fas\", \"fa-eraser\"], [\"class\", \"div-inferior\", 4, \"ngIf\"], [1, \"button\", \"is-danger\", 3, \"disabled\", \"click\"], [1, \"div-inferior\"], [3, \"personaSeleccionada\"], [\"listadoPersonas\", \"\"]],\n    template: function PersonaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0, 1)(2, \"form\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"label\", 5);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"div\", 6)(8, \"div\", 7)(9, \"div\", 8)(10, \"app-select-tipos-persona\", 9);\n        i0.ɵɵlistener(\"tipoPersonaSeleccionado\", function PersonaComponent_Template_app_select_tipos_persona_tipoPersonaSeleccionado_10_listener($event) {\n          return ctx.tipoPersonaSeleccionado($event);\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(11, \"div\", 3)(12, \"div\", 4)(13, \"label\", 5);\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 6)(16, \"div\", 10)(17, \"div\", 7)(18, \"div\", 8)(19, \"app-select-tipos-documento\", 11);\n        i0.ɵɵlistener(\"tipoDocumentoSeleccionado\", function PersonaComponent_Template_app_select_tipos_documento_tipoDocumentoSeleccionado_19_listener($event) {\n          return ctx.tipoDocumentoSeleccionado($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(20, \"div\", 12)(21, \"input\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_21_listener($event) {\n          return ctx.persona.numeroDocumento = $event;\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(22, \"div\", 3)(23, \"div\", 4)(24, \"label\", 5);\n        i0.ɵɵtext(25);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(26, \"div\", 6)(27, \"div\", 10)(28, \"div\", 12)(29, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_29_listener($event) {\n          return ctx.persona.nombres = $event;\n        })(\"focusout\", function PersonaComponent_Template_input_focusout_29_listener($event) {\n          return ctx.formatearNombres($event.originalTarget.name);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\", 12)(31, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_31_listener($event) {\n          return ctx.persona.apellidos = $event;\n        })(\"focusout\", function PersonaComponent_Template_input_focusout_31_listener($event) {\n          return ctx.formatearNombres($event.originalTarget.name);\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(32, \"div\", 3)(33, \"div\", 4)(34, \"label\", 5);\n        i0.ɵɵtext(35);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"div\", 6)(37, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_37_listener($event) {\n          return ctx.persona.razonSocial = $event;\n        })(\"focusout\", function PersonaComponent_Template_input_focusout_37_listener($event) {\n          return ctx.formatearNombres($event.originalTarget.name);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(38, \"div\", 3)(39, \"div\", 4)(40, \"label\", 5);\n        i0.ɵɵtext(41);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"div\", 6)(43, \"div\", 10)(44, \"div\", 7)(45, \"div\", 8)(46, \"app-select-departamentos\", 17, 18);\n        i0.ɵɵlistener(\"departamentoSeleccionado\", function PersonaComponent_Template_app_select_departamentos_departamentoSeleccionado_46_listener($event) {\n          return ctx.departamentoSeleccionado($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(48, \"div\", 7)(49, \"div\", 8)(50, \"app-select-municipios\", 19, 20);\n        i0.ɵɵlistener(\"municipioSeleccionado\", function PersonaComponent_Template_app_select_municipios_municipioSeleccionado_50_listener($event) {\n          return ctx.municipioSeleccionado($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(52, \"div\", 12)(53, \"input\", 21);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_53_listener($event) {\n          return ctx.persona.direccion = $event;\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(54, \"div\", 3)(55, \"div\", 4)(56, \"label\", 5);\n        i0.ɵɵtext(57);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(58, \"div\", 6)(59, \"div\", 10)(60, \"div\", 12)(61, \"input\", 22);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_61_listener($event) {\n          return ctx.persona.telefono = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(62, \"div\", 12)(63, \"input\", 23);\n        i0.ɵɵlistener(\"ngModelChange\", function PersonaComponent_Template_input_ngModelChange_63_listener($event) {\n          return ctx.persona.email = $event;\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(64, \"div\", 24)(65, \"div\", 7)(66, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function PersonaComponent_Template_button_click_66_listener() {\n          return ctx.guardar();\n        });\n        i0.ɵɵtext(67);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(68, PersonaComponent_div_68_Template, 3, 2, \"div\", 26);\n        i0.ɵɵelementStart(69, \"div\", 7)(70, \"button\", 27);\n        i0.ɵɵlistener(\"click\", function PersonaComponent_Template_button_click_70_listener() {\n          return ctx.limpiar();\n        });\n        i0.ɵɵelementStart(71, \"span\", 28);\n        i0.ɵɵelement(72, \"i\", 29);\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵtemplate(73, PersonaComponent_div_73_Template, 3, 0, \"div\", 30);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.labels.tipo);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"tipoPersona\", ctx.persona.tipo);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.labels.identificacion);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"tipoDocumento\", ctx.persona.tipoDocumento);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.numeroDocumento);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.numeroDocumento);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.labels.nombreCompleto);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.nombres);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.nombres);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.apellidos);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.apellidos);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.labels.razonSocial);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.razonSocial);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.labels.domicilio);\n        i0.ɵɵadvance(12);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.direccion);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.direccion);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.labels.contacto);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.telefono);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.telefono);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", ctx.labels.email);\n        i0.ɵɵproperty(\"ngModel\", ctx.persona.email);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", ctx.botones.guardar, \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.creacionPersona);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", !ctx.creacionPersona);\n      }\n    },\n    directives: [i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.NgForm, i3.SelectTiposPersonaComponent, i4.SelectTiposDocumentoComponent, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel, i5.SelectDepartamentosComponent, i6.SelectMunicipiosComponent, i7.NgIf, i8.PersonasComponent],\n    styles: [\"\"]\n  });\n  return PersonaComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}